<!doctype html><html lang=cn-zh><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><style type=text/css>body{font-family:monospace}</style><title>[译]Python的enumerate()函数揭秘</title>
<meta name=description content="A blog maintained by Vimiix."><link rel=stylesheet href=/vimiix-blog/css/style.css></head><body><header>====================<br>== Hi, I'm Vimiix ==<br>====================<div style=float:right>Practice makes perfect (ง •̀_•́)ง</div><br><p><nav><a href=http://vimiix.com/vimiix-blog/><b>首页</b></a>.
<a href=/vimiix-blog/posts/><b>文章列表</b></a>.
<a href=/vimiix-blog/categories/><b>分类</b></a>.
<a href=/vimiix-blog/tags/><b>标签</b></a>.
<a href=/vimiix-blog/friends/><b>友链</b></a>.
<a href=/vimiix-blog/about/><b>关于</b></a>.
<a href=/vimiix-blog/index.xml><b>RSS</b></a>.</nav></p></header><main><article><h1>[译]Python的enumerate()函数揭秘</h1><b><time>2017.12.13 19:51</time></b>
<a href=/vimiix-blog/%20/tags/python>python</a>
<a href=/vimiix-blog/%20/tags/translation>translation</a>
<a href=/vimiix-blog/%20/tags/enumerate>enumerate</a><div><blockquote><p>今天的原文的作者是来自国外的一位 Python“布道师”<a href=https://dbader.org>Dan Bader</a>，他的博客完全就是一个个人品牌的学校。有跟多 Python 技巧，有很多他录制的 Youtube 视频，国内的 Pythonista 们，不妨订阅一下他的每周邮件推送。<a href=https://www.getdrip.com/forms/80014959/submissions/new>订阅链接</a></p><p>今天的译文是他博客中的一篇，点击<a href=https://dbader.org/blog/python-enumerate>查看原文</a></p></blockquote><p>如何以去写以及为什么你应该使用 Python 中的内置枚举函数来编写更干净更加 Pythonic 的循环语句？</p><p><figure><img src=http://vimiix-blog.oss-cn-qingdao.aliyuncs.com/python-enumerate.jpg alt=python-enumerate></figure></p><p>Python 的<code>enumerate</code>函数是一个神话般的存在，以至于它很难用一句话去总结它的目的和用处。</p><p>但是，它是一个非常有用的函数，许多初学者，甚至中级 Pythonistas 是并没有真正意识到。简单来说，<code>enumerate()</code>是用来遍历一个可迭代容器中的元素，同时通过一个计数器变量记录当前元素所对应的索引值。</p><p>让我们来看一个示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Bob&#39;</span>, <span style=color:#e6db74>&#39;Alice&#39;</span>, <span style=color:#e6db74>&#39;Guido&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> index, value <span style=color:#f92672>in</span> enumerate(names):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>index<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>value<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>这段代码会输入如下内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ae81ff>0</span>: Bob
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span>: Alice
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>: Guido
</span></span></code></pre></div><p>正如你所看到的，这个循环遍历了<code>names</code>列表的所有元素，并通过增加从零开始的计数器变量来为每个元素生成索引。</p><p><em>[如果您想知道上面例子中使用的 f&rsquo;&mldr;&lsquo;字符串语法，这是 Python 3.6 及更高版本中提供的一种新的字符串格式化技巧。]</em></p><h2 id=用enumerate让你的循环更加-pythonic>用<code>enumerate()</code>让你的循环更加 Pythonic</h2><p>那么为什么用<code>enumerate()</code>函数去保存运行中的索引很有用呢？</p><p>我发现，有很多从 C 或 Java 背景转过来的新的 Python 开发人员有时使用下面这种<code>range(len(...))</code>方法来保存运行中每个元素的索引，同时再用<code>for</code>循环遍历列表：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 警告: 不建议这么写</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(my_items)):
</span></span><span style=display:flex><span>    print(i, my_items[i])
</span></span></code></pre></div><p>通过巧妙地使用<code>enumerate()</code>函数，就像我在上面的“names”例子中写的那样，你可以<a href=https://dbader.org/blog/pythonic-loops>使你的循环结构看起来更 Pythonic</a>和地道。</p><p>你不再需要在 Python 代码中专门去生成元素索引，而是将所有这些工作都交给<code>enumerate()</code>函数处理即可。这样，你的代码将更容易被阅读，而且减少写错代码的影响。<em>（译者注：写的代码越多，出错几率越高，尽量将自己的代码看起来简洁，易读，Pythonic，才是我们的追求）</em></p><h2 id=修改起始索引>修改起始索引</h2><p>另一个有用的特性是，<code>enumerate()</code>函数允许我们为循环自定义起始索引值。<code>enumerate()</code>函数中接受一个可选参数，该参数允许你为本次循环中的计数器变量设置初始值：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Bob&#39;</span>, <span style=color:#e6db74>&#39;Alice&#39;</span>, <span style=color:#e6db74>&#39;Guido&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> index, value <span style=color:#f92672>in</span> enumerate(names, <span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{</span>index<span style=color:#e6db74>}</span><span style=color:#e6db74>: </span><span style=color:#e6db74>{</span>value<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><p>在上面的例子中，我将函数调用改为<code>enumerate(names, 1)</code>，后面的参数 1 就是本次循环的起始索引，替换默认的 0：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ae81ff>1</span>: Bob
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>: Alice
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>: Guido
</span></span></code></pre></div><p>OK，这段代码演示的就是如何将 Python 的<code>enumerate()</code>函数默认 0 起始索引值修改为 1（或者其他任何整形值，根据需求去设置不同值）</p><h2 id=enumerate背后是如何工作的><code>enumerate()</code>背后是如何工作的</h2><p>你可能想知道<code>enumerate()</code>函数背后是如何工作的。事实上他的部分魔法是通过<a href=https://dbader.org/blog/python-iterators>Python 迭代器</a>来实现的。意思就是每个元素的索引是懒加载的（一个接一个，用的时候生成），这使得内存使用量很低并且保持这个结构运行很快。</p><p>让我们演示一些更多的代码来表达我的意思：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> names <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Bob&#39;</span>, <span style=color:#e6db74>&#39;Alice&#39;</span>, <span style=color:#e6db74>&#39;Guido&#39;</span>]
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> enumerate(names)
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;</span>enumerate object at <span style=color:#ae81ff>0x1057f4120</span><span style=color:#f92672>&gt;</span>
</span></span></code></pre></div><p>在上面这个代码片段中，正如你所见，我使用了和前面一样的示例代码。但是，调用<code>enumerate()</code>函数并不会立即返回循环的结果，而只是在控制台中返回了一个<code>enumerate</code>对象。</p><p>正如你所看到的，这是一个“枚举对象”。它的确是一个迭代器。就像我说的，它会在循环请求时懒加载地输出每个元素。</p><p>为了验证，我们可以取出那些“懒加载”的元素，我计划在这个迭代器上调用 Python 的内置函数<code>list()</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> list(enumerate(names))
</span></span><span style=display:flex><span>[(<span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#39;Bob&#39;</span>), (<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;Alice&#39;</span>), (<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;Guido&#39;</span>)]
</span></span></code></pre></div><p>对于输入<code>list()</code>中的每个<code>enumerate()</code>迭代器元素，迭代器会返回一个形式为<code>（index，element）</code>的元组作为 list 的元素。在典型的 for-in 循环中，你可以利用 Python 的<a href=https://dbader.org/blog/python-nested-unpacking>数据结构解包</a>功能来充分利用这一点特性：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>for</span> index, element <span style=color:#f92672>in</span> enumerate(iterable):
</span></span><span style=display:flex><span>    <span style=color:#75715e># ...</span>
</span></span></code></pre></div><h2 id=总结python-中的-enumerate-函数---关键点>总结：Python 中的 enumerate 函数 - 关键点</h2><ul><li><code>enumerate</code>是 Python 的一个内置函数。你应该充分利用它通过循环迭代自动生成的索引变量。</li><li>索引值默认从 0 开始，但也可以将其设置为任何整数。</li><li><code>enumerate</code>函数是从 2.3 版本开始被添加到 Python 中的，详情见<a href=https://www.python.org/dev/peps/pep-0279/>PEP279</a>。</li><li>Python 的<code>enumerate</code>函数可以帮助你编写出更加 Pythonic 和地道的循环结构，避免使用笨重且容易出错的手动生成索引。</li><li>为了充分利用<code>enumerate</code>的特性，一定要研究 Python 的迭代器和<a href=https://dbader.org/blog/python-nested-unpacking>数据结构解包</a>功能。</li></ul></div></article></main><aside><div><div><h3>LATEST POSTS</h3></div><div><ul><li><a href=/vimiix-blog/posts/2023-06-21-manage-go-multiple-versions/>Shell 函数实现Go语言多版本管理轻量级方案</a></li><li><a href=/vimiix-blog/posts/2021-12-21-learn-distributed-transaction/>分布式事务笔记(XA,TCC,Saga)</a></li><li><a href=/vimiix-blog/posts/2021-09-01-simulate-disk-readonly-scenario/>磁盘只读（readonly）故障场景模拟</a></li><li><a href=/vimiix-blog/posts/2021-07-08-opengauss-driver-and-orm/>使用SQLAlchemy以多IP方式连接openGauss数据库</a></li><li><a href=/vimiix-blog/posts/2021-04-07-concurrency-in-go/>Golang的并行模式实践</a></li></ul></div></div></aside><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="http://vimiix.com/vimiix-blog/posts/2017-12-13-pythons-enumerate-function-demystified/",this.page.identifier="/vimiix-blog/posts/2017-12-13-pythons-enumerate-function-demystified/"};(function(){var e=document,t=e.createElement("script");t.src="https://vimiix-blog.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><footer><p><a href=https://github.com/vimiix><b>Github</b></a>.
<a href=https://www.douban.com/people/vimiix/><b>Douban</b></a>.
<a href=mailto:i@vimiix.com><b>Email</b></a>.<br>&copy; 2023
Copyright (c) 2017-2021, Vimiix Yao; All rights reserved.
<a href=https://beian.miit.gov.cn/>京ICP备19015214号-1</a></p></footer></body></html>